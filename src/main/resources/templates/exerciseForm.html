<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="UTF-8">
    <title>FitBook | Accounts</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link href="../static/css/account.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,700&display=swap" rel="stylesheet">
</head>

<header class='wrapper-header'>
    <a href="/" class="header-logo"><img src="../static/images/Logo-Wilgen-Training.png" alt="brand" class="logo"></a>
    <h1 class="header-title" th:text="${selectedUser.name} +', kies je score voor ' + ${selectedExercise.name}"></h1>
    <nav class="navigation">
        <a href="/" class="button header-button">TERUG</a>
    </nav>
</header>

<body>
<main class="main-wrapper">

    <div id="chart_div" style="width: 50%; height: 400px;"></div>

    <div>
        <body>
        <form id="scoreForm" method="POST" th:action="@{/exercise/newFact}" th:object="${exerciseFact}">
            <input type="number" th:field="*{score}" required placeholder="Score" max="10000"/>
            <span class="validationError"
                  th:if="${#fields.hasErrors('score')}"
                  th:errors="*{score}">Score error</span>
            <input type="submit" value="SCORE TOEVOEGEN" class="button gridspan"/>
        </form>

        </body>
    </div>

    <div th:each="exerciseFact : ${exerciseFacts}">
        <span th:text="${exerciseFact.toString()}"></span><br/>
    </div>

    <script>
        document.getElementById("scoreForm").addEventListener("submit", (ev) => {
            console.log(ev.toString())
        })

    </script>

    <script th:inline="javascript" type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script th:inline="javascript" type="text/javascript">
        google.charts.load('current', {'packages': ['corechart']});

        const exerciseFacts = [[${exerciseFacts}]];
        const exerciseScores = [["string", "string"], ...exerciseFacts.map(({date, score}) => {
            return [date, score];
        })];

        if(exerciseFacts.length !== 0) {
            google.charts.setOnLoadCallback(drawChart);
        }

        function drawChart() {

            const dataTable = google.visualization.arrayToDataTable(exerciseScores);

            const options = {
                title: 'Jouw Performance',
                hAxis: {title: 'Year', titleTextStyle: {color: '#333'}},
                vAxis: {minValue: 0}
            };

            const chart = new google.visualization.AreaChart(document.getElementById('chart_div'));
            chart.draw(dataTable, options);
        }
    </script>
</main>
</body>
</html>


